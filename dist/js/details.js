"use strict";!function(){$("footer").load("../html/foot.html");var i=$.cookie("dataId"),a=$.cookie("uName");function t(n,i){new Promise(function(a){$.ajax({type:"post",url:"../api/pingLun.php",data:{sid:n,uname:i},success:function(n){var i=JSON.parse(n);a(i)}})}).then(function(n){$(".star").find("b").html(n.length),$(".pingLunCheck").find("span").html(n.length),$(".pingLunList").html(n.map(function(n){return'<li data-id="'.concat(n.id,'">\n                               <ul>\n                                   <li>\n                                       <img src="../img/vipHead.png" alt="">\n                                   </li>\n                                   <li>').concat(n.uname,'</li>\n                                   <li>注册会员</li>\n                               </ul>\n                               <ul>\n                                    <li>\n                                        <div>商品评分 <span><i style="width: ').concat(n.star,'"></i></span></div>\n                                        <div>评论时间：').concat(n.dateline,"</div>\n                                    </li>\n                                    <li>\n                                        ").concat(n.content,'\n                                    </li>\n                                    <li class="clearfix">\n                                        <p class="zan">有用(<b>').concat(n.zan,"</b>)</p>\n                                    </li>\n                               </ul>\n                           </li>")}).join("")).on("click",".zan",function(){var i=this,a=$(this).find("b").html(),n=$(this).parent().parent().parent().attr("data-id");a++,new Promise(function(i){$.ajax({type:"post",url:"../api/pingLun.php",data:{zan:a,id:n},success:function(n){i(n)}})}).then(function(n){layui.use("layer",function(){layui.layer.msg(n,{icon:6,time:800,anim:2})}),$(i).find("b").html(a)})})})}!function s(n){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;$.ajax({type:"post",url:"../api/details.php",data:{id:n},success:function(n){var i=JSON.parse(n),a=JSON.parse(i[0].imgsrc),t=JSON.parse(i[0].size);$(".details").html(i.map(function(n){return'        <div class="goods-introduce clearfix">\n            <div class="goods-introduce-left">\n                <div class="goods-img magnify">\n                    <div class=\'large\'></div>\n                    <img src="'.concat(a[c][0],'" alt="" class="example"/>\n                </div>\n                <div class="goods-smallImg clearfix">\n                    <ul>\n                        ').concat(function(){for(var n="",i=0;i<a[c].length;i++)n+=' <li><div class="uparrow"></div><a href="javascript:;" class="active"><img src="'.concat(a[c][i],'" alt="" /></a></li>');return n}(),'\n                    </ul>\n                </div>\n                <div class="shareLink clearfix">\n                    <span>分享到：</span>\n                    <a href="" style="background-position: 0 -64px;"></a>\n                    <a href="" style="background-position: 0 -19px;"></a>\n                    <a href="" style="background-position: 0 3px;"></a>\n                    <a href="" style="background-position: 0 -41px;"></a>\n                    <a href="" style="background-position: 0 -103px;"></a>\n                    <a href="" style="background-position: 0 2px;"></a>\n                </div>\n            </div>\n            <div class="goods-introduce-right">\n                <h1 class="clearfix"><i>').concat(n.title,'</i><span>更多<a href="###">').concat(n.brand,'</a></span></h1>\n                <div class="goods-info">\n                    <div class="price">吊牌价：<span style="text-decoration: line-through;">￥').concat((1.2*n.price).toFixed(2),'</span></div>\n                    <div class="realprice">销售价：<span>￥').concat(n.price,"</span>(7.4折) 立省 ：￥").concat(((1.2*n.price).toFixed(2)-n.price).toFixed(2),'</div>\n                    <div class="comment">好评度：<i></i><span>(已有0人评论)</span></div>\n                    <div class="carriage">运费：名鞋库会员满399包邮 ( 不包括货到付款 )</div>\n                </div>\n                <div class="promotion">\n                    <span>促销信息</span><span>满299减10 599减20 999减50  限购3件</span>\n                </div>\n                <div class="sizetable">\n                    <ul>\n                        <li class="size clearfix"><span>尺码：</span>').concat(function(){for(var n="",i=0;i<t.length;i++)n+='<a href="javascript:;">'.concat(t[i],"<i></i></a>");return n}(),'</li>\n                        <li class="color clearfix"><span>颜色：</span>').concat(function(){for(var n="",i=0;i<a.length;i++)n+='<a href="javascript:;" data-id="'.concat(i,'"><img src="').concat(a[i][0],'" alt=""><i></i></a>');return n}(),'</li>\n                        <li class="numble clearfix"><span>购买数量：</span><input type="button" value="-" id="sub" /><input type="number" value="1" id="sum" oninput="this.value=this.value.replace(/\\D/g,\'\')"  /><input type="button" value="+" id="add" /><b>已到达最大库存</b></li>\n                    </ul>\n                    <div class="collect">\n                        <a href=""></a>\n                    </div>\n                    <div class="size-translation">\n                        <a href=""></a>\n                    </div>\n                </div>\n                <div class="buygoods">\n                    <div class="buyinfo">\n                        您将购买<span style="color: #cc0000;"> 1 </span>件\n                        <i style="color:#cc0000;">  </i>\n                    </div>\n                    <input type="button" name="" id="" value="" />\n                    <input type="button" name="" id="addCart" value="" />\n                </div>\n                <div class="safe">\n                    <span>名鞋库保障：</span>\n                    <img src="../img/zheng.png" alt="" />\n                    <i>正品认证</i>\n                    <img src="../img/tui.png" alt="" />\n                    <i>自由退货</i>\n                    <img src="../img/mian.png" alt="" />\n                    <i>全场满399免邮</i>\n                </div>\n            </div>\n            \x3c!--<div class="bigImgArea">--\x3e\n                \x3c!--<img src="../img/xxx/xxx22_1.jpg" />--\x3e\n            \x3c!--</div>--\x3e\n        </div>\n    ')}).join("")),$(".color").find("a").eq(c).addClass("active").find("i").css("display","block"),$(".size").on("click","a",function(){$(this).siblings().removeClass("active").find("i").css("display","none"),$(this).addClass("active").find("i").css("display","block")}),$(".color").on("click","a",function(){s($.cookie("dataId"),$(this).attr("data-id"))}),$(".goods-smallImg").on("mouseenter","li",function(){$(".goods-img img").attr("src","".concat($(this).find("img").attr("src")))}),$(".numble").on("click","#sub",function(){var n=$("#sum").val();--n<1&&(n=1),$(this).next().next().next().css("visibility","hidden"),$("#sum").val(n),$(".buyinfo span").html(" ".concat(n," "))}).on("click","#add",function(){var n=$("#sum").val();++n>=i[0].stock&&(n=i[0].stock,$(this).next().css("visibility","visible")),$("#sum").val(n),$(".buyinfo span").html(" ".concat(n," "))}).on("input","#sum",function(){var n=$(this).val();n<1?(n=1,$(this).val(1),$(this).next().next().css("visibility","hidden")):n>=i[0].stock?(n=i[0].stock,$(this).val(i[0].stock),$(this).next().next().css("visibility","visible")):$(this).next().next().css("visibility","hidden"),$(".buyinfo span").html(" ".concat($(this).val()," "))}),$(".path").html("您当前的位置：".concat(i[0].type," >> ").concat(i[0].brand," >> ").concat(i[0].title)),$("h1").on("click","a",function(){$.cookie("kw",$(this).html().trim()),window.open("list.html")}),$("#addCart").on("click",function(){if($(".size").find("a").hasClass("active")){var n=$(".size").find(".active").text(),a=$(".color").find(".active").find("img").attr("src");new Promise(function(i){$.ajax({type:"post",url:"../api/cart.php",data:{sid:$.cookie("dataId"),size:n,color:a,num:$("#sum").val().trim(),uname:$.cookie("uName")},success:function(n){i(n)}})}).then(function(n){var i=JSON.parse(n);layui.use("layer",function(){layui.layer.msg(i.msg,{icon:1,time:800,anim:2})}),$("body").find(".cart").find("span").html(i.totalNum)})}else layui.use("layer",function(){layui.layer.msg("请选择码数",{icon:2,time:800,anim:2})})}),$(".example").imagezoomsl({cursorshade:!0,magnifycursor:"crosshair",cursorshadecolor:"#fff",cursorshadeopacity:.3,cursorshadeborder:"1px solid black",zindex:"",stepzoom:.5,zoomrange:[2,2],zoomstart:2,disablewheel:!0})}})}(i),$(".pingLunInp").on("click","span",function(n){$(this).find("i").css("width","".concat(n.offsetX,"px"))}),$(".pingLunBtn").on("click",function(){"null"==a?layui.use("layer",function(){layui.layer.open({title:"噔噔蹬，登录后再评论大兄弟",content:"是否跳转到登录页面",btn:["给我跳","告辞"],btn1:function(){location.href="login.html"},closeBtn:2,anim:4})}):$(".pingLunInp").find("textarea").val().trim()?$.ajax({type:"post",url:"../api/pingLun.php",data:{sid:i,uname:a,content:filter($(".pingLunInp").find("textarea").val().trim()),star:$(".pingLunInp").find("i").css("width")},success:function(n){layui.use("layer",function(){layui.layer.open({content:n,btn:"ojbk",closeBtn:2,anim:1})}),$(".pingLunInp").find("textarea").val("").focus(),$(".pingLunInp").find("i").css("width","0"),t(i,a)}}):layui.use("layer",function(){layui.layer.open({content:"请填写评论再提交",btn:"ojbk",closeBtn:2,anim:6})})}),t(i,a)}();